---
title: "Probability basics for Bayesian analysis (WIP)"
format: 
  revealjs:
    theme: serif
    navigation-mode: vertical
    # incremental: true
    transition: slide
    background-transition: fade
    echo: true
    freeze: auto
---

```{css}
code {
    font-size: 1.5em;
}
```

```{r echo=FALSE}
library(tidyverse)
library(knitr)
mytheme <- theme(
  legend.text = element_text(size=15),
  legend.title = element_text(size=20),
  axis.title = element_text(size=20),
  axis.text = element_text(size=15))

helper_plot_X_probs <- (function(X_tibble)
  (X_tibble %>%
    group_by(X) %>%
    summarise(n=n()) %>%
    mutate(p=n/sum(n)) %>%
    ggplot(aes(x=X, y=p)) 
    + geom_bar(stat="identity")
    + mytheme))

helper_plot_Y_probs <- (function(Y_tibble)
  (Y_tibble %>%
    group_by(Y) %>%
    summarise(n=n()) %>%
    mutate(p=n/sum(n)) %>%
    ggplot(aes(x=Y, y=p)) 
    + geom_bar(stat="identity")
    + mytheme))

helper_plot_XY_probs <- (function(XY_tibble)
  (XY_tibble %>%
    group_by(X,Y) %>%
    summarise(n=n()) %>%
    ungroup() %>%
    mutate(p=n/sum(n)) %>%
    ggplot(aes(x=X, y=Y, fill=p)) 
    + geom_tile(color="black", lwd=1.5, linetype=1)
    + geom_text(aes(label = p), 
                color = "white", 
                size = 7) 
    + mytheme))

helper_plot_XY_density <- (function(XY_tibble)
  XY_tibble %>%
  ggplot(aes(x=X, y=Y)) 
  + geom_density_2d_filled()
  + mytheme)
```

# A motivating example

To estimate how many times I sneeze per hour, I wait and measure the time till my forth sneeze.

- $X$ - unobserved (parameter) - my rate of sneezes per hour 
- $Y$ - observed - the time till my forth sneeze 

- Prior: $X \sim \Gamma(2,6)$
- Likelihood: $Y \vert _X \sim \Gamma(4,X)$
- Posterior: $X \vert _Y \sim \Gamma(2+4,6+Y)$


# Background

[What distinguishes measure theory and probability theory?](https://math.stackexchange.com/questions/118221/what-distinguishes-measure-theory-and-probability-theory)


# Sample space

- $\Omega$ - a set

- Each $\omega$ in $\Omega$ is one possible outcome in our uncertain world.

- In computational uses, $\Omega$ is finite. 

- But when we phrase a statistical model, it is often an infinite mathematical construct.

## Sample space example

```{r}
N <- 100
Omega <- tibble(X = rgamma(N, 2, 6),
                Y = rgamma(N, 4, X))

Omega %>% kable()
```

## Sample space - remarks
- Usually we do not actually care about the elements $\omega$ in $\Omega$.

- We think in terms of events and random variables. 

- The sample space behind them is implicit.

# Events

- Subsets that we care about are called "events". 



## Events example
"all outcomes $\omega$ in which I waited at least half an hour"

```{r}
Omega %>%
filter(Y>0.5) %>%
kable()
```

## Event space
- $\mathcal{F}$ - the event space, is the set of events that can be conceptualized in our model of the world.
  - In other words, events where it makes sense to ask whether they occur or not.

- $\mathcal{F}$ is assumed to be a so-called $\sigma$-algebra.
  - It means it has some kind of symmetry that makes it sensible.

## Event space example

In this sample space:
```{r}
tibble(U=c(1,1,2,2),
       V=c(3,4,3,4)) %>%
kable()
```
if $U$ is part of our model of the world, but $V$ is not, then our event space contains events such as $U=1$ but not events such as $V=3$.

## Varying the event space
- When we talk about conditional probability, etc., 
- .. it can always be phrased by conditioning on a different event space.
- .. but we will not use this terminology today.

# Random variables
- A random variable is a function $\Omega \to \mathbb{R}$.
- .. which is "measurable" in the event space.

## Random variables example

```{r}
Omega %>% kable()
```

## Random variables example - cont.
```{r}
Omega$X[13]
```


# Recommended reading
