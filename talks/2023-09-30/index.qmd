---
title: "Probability basics for Bayesian analysis (WIP)"
format: 
  revealjs:
    theme: serif
    navigation-mode: vertical
    # incremental: true
    transition: slide
    background-transition: fade
    echo: true
    freeze: auto
---

```{css echo=FALSE}
code {
    font-size: 1.3em;
}
```


```{r echo=FALSE}
library(tidyverse)
library(knitr)
mytheme <- theme(
  legend.text = element_text(size=15),
  legend.title = element_text(size=20),
  axis.title = element_text(size=20),
  axis.text = element_text(size=15))

helper_plot_XY_density <- (function(XY_tibble)
  XY_tibble %>%
  ggplot(aes(x=X, y=Y)) 
  + geom_density_2d_filled()
  + mytheme)
```

# A motivating example

To estimate how many times I sneeze per hour, I wait and measure the time till my forth sneeze.

- $X$ - unobserved (parameter) - my rate of sneezes per hour 
- $Y$ - observed - the time till my forth sneeze 

- Prior: $X \sim \Gamma(2,6)$
- Likelihood: $Y \vert _X \sim \Gamma(4,X)$
- Posterior: $X \vert _Y \sim \Gamma(2+4,6+Y)$


# Background

[What distinguishes measure theory and probability theory?](https://math.stackexchange.com/questions/118221/what-distinguishes-measure-theory-and-probability-theory)


# Sample space

- $\Omega$ - a set

- Each $\omega$ in $\Omega$ is one possible outcome in our uncertain world.

- In computational uses, $\Omega$ is finite. 

- But when we phrase a statistical model, it is often an infinite mathematical construct.

## Sample space example

```{r}
N <- 100
set.seed(31)
Omega_finite <- tibble(X = rgamma(N, 2, 6),
                Y = rgamma(N, 4, X))

Omega_finite %>% kable()
```
## Sample space example - cont


```{r}
(Omega_finite %>%
  ggplot(aes(x=X,y=Y))
  + geom_point(size=5))
```


## Sample space - remarks
- Usually we do not actually care about the elements $\omega$ in $\Omega$.

- We think in terms of events and random variables. 

- The sample space behind them is implicit.

# Events

- Subsets that we care about are called "events". 


## Events example
"all outcomes $\omega$ in $\Omega_finite$ in which I waited at least five hours"

```{r}
Omega_finite %>%
filter(Y>5) %>%
kable()
```

## Event space
- $\mathcal{F}$ - the event space, is the set of events that can be conceptualized in our model of the world.
  - In other words, events where it makes sense to ask whether they occur or not.

- $\mathcal{F}$ is assumed to be a so-called $\sigma$-algebra.
  - It means it has some kind of symmetry that makes it sensible.

## Event space example

In this sample space:
```{r}
tibble(U=c(1,1,2,2),
       V=c(3,4,3,4)) %>%
kable()
```
if $U$ is part of our model of the world, but $V$ is not, then our event space contains events such as $U=1$ but not events such as $V=3$.

## Varying the event space
- When we talk about conditional probability, etc., 
- .. it can always be phrased by conditioning on a different event space.
- .. but we will not use this terminology today.

# Random variables
- A random variable is a function $\Omega \to \mathbb{R}$.
- .. which is "measurable" in the event space.

## Random variables example

```{r}
Omega_finite %>% kable()
```

## Random variables example - cont.
```{r}
Omega_finite$X[13]
```

## Random variables coexist

```{r}
c(Omega_finite$X[13],
  Omega_finite$Y[13])
```

## Random vectors

$(X,Y)$ may be considered a random vector, viewed as a function $\Omega_finite \to \mathbb{R}^2$
$$\omega \mapsto (X(\omega), Y(\omega))$$

## Events of random variables

$$Y>5$$
means the subset of $\Omega_finite$:
$$\{\omega \in \Omega_finite \vert Y(\omega)>5\}$$


```{r}
Y_is_more_than_five <- 
  Omega_finite %>% 
  filter(Y>5)
nrow(Y_is_more_than_five)
```
## Events of random variables - cont.

$$(Y \in [5,9], X<0.3)$$
means the subset of $\Omega_finite$:
$$= \{\omega \in \Omega_finite \vert Y(\omega) \in [5,9],  X(\omega)<0.3\}$$
$$= \{\omega \in \Omega_finite \vert 5 \leq Y(\omega) \leq 9, X(\omega)<0.3\}$$

# Probability

- A probability measure $\mathbb{P}$ is a function from to $\mathcal{F} \to [0,1]$, satisfying [Kolmogorov's axioms](https://www.britannica.com/topic/Foundations-of-the-Theory-of-Probability):
  - $\mathbb{P}(E) \geq 0$ for all $E$ in $\mathcal{F}$
  - $\mathbb{P}(\Omega) = 1$
  - $\mathbb{P}(\bigcup_{i=1,2,...} E_i) = \sum_{i=1,2,...} \mathbb{P}(E_i)$

- A sample space with a probability measure is called a probability space.

## Probability example

For our finite example, we may define probabilities proportional to number of outcomes.

```{r}
P <- (function(event)
  nrow(event)/N)

P(Y_is_more_than_five)
```

# Distribution

A random variable $Y: \Omega \to \mathbb{R}$ pushes a probability measure $\mathbb{P}$ over $\Omega$ to a probability measure $P_Y$ over $\mathbb{R}$, called its distribution.

$$P_X((0,0.3)) =$$
$$\mathbb{P}(Y \in (0,0.3)) =$$
$$\mathbb{P}(0 < X < 0.3)$$

## Distribution example

```{r}
(Omega_finite %>%
  ggplot(aes(x=X, y=..density..)) 
  + geom_histogram(bins=50)
  + mytheme)
```

## Distribution example - cont.

$$P_X((0,0.3)) = \mathbb{P}(0 < X < 0.3)$$

```{r}
(Omega_finite %>% ggplot() + mytheme
  + geom_histogram(aes(x=X, y=..density..))
  + geom_rect(xmin=0, xmax=0.3,
              ymin=0, ymax=100, 
              fill="lightgreen", alpha=0.01))
```

## Distribution example - cont.


```{r}
Omega_finite %>%
filter(0 < X & X < 0.3) %>%
P()
```



## Joint distribution

Similarily, the distribution of a random vector $(X,Y)$ is a probability measure over the plane $\mathbb{R^2}$.

It is also called the *joint distribution* of $X$ and $Y$.

```{r}
Omega_finite %>% helper_plot_XY_density()
```


# Recommended reading
